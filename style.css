/* ===================== THEME & BASE ===================== */
*{box-sizing:border-box}
html,body{height:100%}
html{-webkit-text-size-adjust:100%}
:root{
  /* Midnight (blue) fallback */
  --bg:#0b132b; --panel:#0f2a3d; --felt-1:#13425a66; --felt-2:#0e2a3d8a;
  --ink:#0b3344; --line:#ffffff22; --text:#ffffff;
}

/* Active: Green Felt */
body[data-theme="felt"]{
  --bg:#063c24;
  --panel:#0b3a21;
  --felt-1:#0c602f66;   /* subtle top glow */
  --felt-2:#0949238a;   /* bottom vignette */
  --ink:#0a3a28;        /* badge/total background */
  --line:#ffffff22;     /* dashed outlines */
  --text:#ffffff;
}

body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  background:var(--bg);
  color:var(--text);
  overflow-x:hidden;
  user-select:none;
  padding-bottom: 120px; /* room for sticky controls on iOS */
}

/* ===================== HEADER ===================== */
#topbar{
  position:relative; z-index:50;
  max-width:1100px; margin:10px auto 6px;
  display:flex; align-items:center; justify-content:space-between; gap:12px;
  padding-left: calc(14px + env(safe-area-inset-left,0px));
  padding-right: calc(14px + env(safe-area-inset-right,0px));
}
#brand{
  font-weight:800; letter-spacing:.2px;
  font-size:clamp(16px,2.2vw,22px);
  color:var(--text);
  text-shadow:0 1px 0 #0006;
  white-space:nowrap;
}
.player-badge{
  display:inline-flex; align-items:center; gap:10px;
  padding:8px 12px; border-radius:999px;
  background:
    radial-gradient(120% 160% at 15% 30%, #ffffff1a, transparent 50%),
    linear-gradient(180deg, #174b5f, #0f2f41);
  border:1px solid #ffffff26;
  box-shadow:0 6px 18px rgba(0,0,0,.35), inset 0 0 0 1px #4fdad833;
  color:#eaffff; max-width:min(68vw,420px); overflow:hidden;
}
.player-badge .tag{
  display:grid; place-items:center;
  width:30px; height:30px; border-radius:999px;
  font-weight:900;
  background:radial-gradient(circle at 30% 30%, #7ff5e0, #2ac2b0);
  color:#04323a; box-shadow:0 2px 6px rgba(0,0,0,.3);
  flex:0 0 auto;
}
.player-badge .label{ opacity:.9; font-weight:700; white-space:nowrap; }
.player-badge .money{
  margin-left:2px; font-weight:900; letter-spacing:.2px;
  padding:2px 8px; border-radius:8px;
  background:var(--ink); border:1px solid #ffffff1f;
  box-shadow:inset 0 0 0 1px #1bd2c955; white-space:nowrap;
}
@media (max-width:420px){
  .player-badge{ gap:8px; padding:6px 10px;
    max-width:calc(100vw - (env(safe-area-inset-left,0px)+env(safe-area-inset-right,0px)+24px));
  }
  .player-badge .label{ display:none; }
  .player-badge .money{ padding:2px 6px; }
}

/* ===================== DEALER AREA ===================== */
#dealerArea{
  position:relative; max-width:1100px; margin:8px auto; padding:26px 12px 42px;
  background:
    radial-gradient(120% 120% at 50% -20%, var(--felt-1), transparent 60%),
    radial-gradient(120% 120% at 50% 120%, var(--felt-2), transparent 65%),
    var(--panel);
  border:1px dashed var(--line); border-radius:18px; overflow:hidden;
}

/* ===== CSSâ€‘only dealing shoe (no image) ===== */
.deal-shoe{
  --w: 170px;                 /* desktop width */
  position:absolute;
  right:16px; top:14px;
  width:var(--w); aspect-ratio: 2.2 / 1;  /* body of shoe */
  border-radius: 12px 16px 16px 12px;
  background: linear-gradient(180deg, #1c3447, #102735);
  box-shadow: 0 10px 24px rgba(0,0,0,.35), inset 0 0 0 1px #ffffff18;
  z-index:12; pointer-events:none;
}
.deal-shoe::after{
  content:""; position:absolute; right:6%; top:18%;
  width:34%; height:64%; border-radius:10px;
  background: linear-gradient(180deg, #8aa6ba, #6a859b);
  box-shadow: inset 0 0 0 1px #ffffff33, inset 0 -10px 16px rgba(0,0,0,.25);
}
.deal-shoe::before{
  content:""; position:absolute; right:12%; top:24%;
  width:30%; height:54%; border-radius:8px;
  background: repeating-linear-gradient(90deg,#dbe6ef 0 3px,#c9d7e4 3px 6px);
  filter: brightness(.96); box-shadow: inset 0 0 0 1px #ffffff55;
}
@media (max-width: 520px){
  .deal-shoe{ --w: 120px; right:10px; top:10px; }
}

/* dealer tray: cards + total together */
#dealerTray{ display:flex; align-items:center; justify-content:center; gap:10px; margin-top:46px }
#dealerCards{ display:flex; gap:8px }
#dealerTotal{
  background:var(--ink); border:1px solid var(--line); border-radius:10px;
  padding:4px 10px; font-weight:800; min-width:34px; text-align:center
}

/* ===================== SEATS / TABLE ===================== */
#seatsArea{
  position:relative; max-width:1100px; margin:12px auto 0; padding:24px 16px 26px;
  background:
    radial-gradient(110% 110% at 50% -10%, var(--felt-1), transparent 60%),
    radial-gradient(110% 110% at 50% 120%, var(--felt-2), transparent 65%),
    var(--panel);
  border:1px dashed var(--line); border-radius:18px; min-height:380px;
  display:grid; gap:18px;
}
#seatsArea.solo{grid-template-columns:1fr}
#seatsArea.duo {grid-template-columns:repeat(2,1fr)}
#seatsArea.trio{grid-template-columns:repeat(3,1fr)}
#seatsArea.solo .seat{ width:clamp(320px,42vw,520px); margin:0 auto }

.seat{ position:relative; min-height:260px; border-radius:16px }
.seat.fade-out{ opacity:0; transition:opacity .35s ease }

/* Dotted bet area */
.bet-box{
  position:absolute; top:18px; left:18px; right:18px; bottom:18px;
  background:url('assets/bet-box.svg') center/contain no-repeat;
  z-index:2; transition:transform .12s ease, filter .12s ease
}
.seat.active .bet-box{ filter:drop-shadow(0 0 10px rgba(121,225,247,.35)) }
.bet-box:active{ transform:scale(.985) }

/* Cards live INSIDE the dotted box */
.seat .cards{
  position:absolute; top:34px; left:34px; right:34px; bottom:30px;
  display:flex; flex-wrap:wrap; gap:8px; justify-content:center; align-items:center; z-index:4
}

/* Seat total badge */
.total{
  position:absolute; top:6px; left:50%; transform:translateX(-50%);
  background:var(--ink); border:1px solid var(--line); border-radius:10px;
  padding:2px 10px; font-weight:800; z-index:5
}

/* Bet stack host (center-bottom of bet box area) */
.seat .bet-stack{
  position:absolute; left:50%; transform:translateX(-50%);
  bottom:8px; width:60%; height:38%; pointer-events:none; z-index:5;
}

/* ===================== CARDS ===================== */
.card{
  width:66px; height:96px; border-radius:10px; background:#fff; color:#222; display:grid; place-items:center;
  box-shadow:0 12px 18px rgba(0,0,0,.25); transition:transform .18s ease, opacity .18s ease
}
.card.red{ color:#c73742 }
.card.back{ background:linear-gradient(135deg,#234a68 0%,#2a5c7f 100%); color:#fff }
.card .small{ position:absolute; top:6px; left:6px; font-size:12px; font-weight:800 }
.card .big{ font-size:24px; font-weight:800; line-height:1 }
.card .suit{ position:absolute; bottom:6px; right:6px; font-size:12px }
.card.deal-slow{ opacity:0; transform:translateY(-10px) scale(.95) }
.card.deal-slow.show{ opacity:1; transform:translateY(0) scale(1) }

/* Flying card (shoe animation) */
.flying-card{
  position:fixed; left:0; top:0; width:66px; height:96px; z-index:999;
  border-radius:10px; background:#fff; color:#222; display:grid; place-items:center;
  box-shadow:0 12px 18px rgba(0,0,0,.25);
  transition: transform .28s cubic-bezier(.22,.9,.2,1), opacity .18s ease;
  will-change: transform, opacity;
}
.flying-card.red{ color:#c73742 }
.flying-card.back{ background:linear-gradient(135deg,#234a68 0%,#2a5c7f 100%); color:#fff }
.flying-card .small{ position:absolute; top:6px; left:6px; font-size:12px; font-weight:800 }
.flying-card .big{ font-size:24px; font-weight:800 }
.flying-card .suit{ position:absolute; bottom:6px; right:6px; font-size:12px }

/* ===================== PAYOUT BUBBLE ===================== */
.payout{
  position:absolute; top:50%; left:50%; transform:translate(-50%,-50%) scale(.9);
  background:#0a3a50; border:1px solid #2dd4bf66; border-radius:999px;
  padding:8px 16px; font-weight:800; opacity:0; z-index:6;
  transition:transform .16s ease, opacity .16s ease
}
.payout.show{ opacity:1; transform:translate(-50%,-50%) scale(1) }
.payout.win{ color:#67f6d1 } .payout.push{ color:#9fc0ff } .payout.lose{ color:#ff8a8a }

/* ===================== CONTROL BAR ===================== */
#controlBar{
  max-width:1100px; margin:12px auto; display:flex; align-items:center; gap:12px;
  justify-content:space-between; flex-wrap:wrap; padding:0 8px
}
#chipsArea{ display:flex; gap:10px; align-items:center }
#seatToggle{ display:flex; gap:8px; justify-content:center; flex:1 }
#seatToggle button{ border:none; border-radius:10px; padding:8px 10px; background:#0e2a3b; color:#c9e6ff }
#seatToggle button.active{ background:#135066; color:#fff }
#actionButtons{ display:flex; gap:12px; align-items:center }

#controlsArea{
  position: fixed;
  left: 50%;
  transform: translateX(-50%);
  bottom: max(12px, env(safe-area-inset-bottom));
  z-index: 1000; /* above everything */

  width: min(100%, 920px);
  padding: 10px 14px;
  border-radius: 14px;
  background: rgba(0,0,0,.25);
  box-shadow: 0 8px 28px rgba(0,0,0,.35);
  backdrop-filter: blur(8px);

  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;

  pointer-events: none;
}
#chipsArea, #seatToggle, #actionButtons{
  display: flex;
  align-items: center;
  gap: 10px;
  pointer-events: auto;
}

/* Buttons look */
.btn{
  --bg:#1e3a4a; --gl:#40e0d0; --txt:#e7fbff;
  position:relative; border:none; color:var(--txt);
  background:linear-gradient(180deg,#1a3140,var(--bg));
  padding:10px 16px; border-radius:12px; font-weight:900; letter-spacing:.2px;
  box-shadow:0 4px 0 #0a2230,0 0 0 1px #0b2c3a inset,0 12px 24px rgba(0,0,0,.25);
  transform:translateY(0); transition:transform .08s ease, box-shadow .12s ease, filter .12s ease
}
.btn:hover:not(.dimmed){ transform:translateY(-2px); filter:brightness(1.08) }
.btn:active:not(.dimmed){ transform:translateY(1px); box-shadow:0 2px 0 #092030,0 0 0 1px #0b2c3a inset }
.btn.dimmed, .btn:disabled{ opacity:.45; cursor:not-allowed; filter:grayscale(.15);
  box-shadow:0 2px 0 #091b26,0 0 0 1px #0b2c3a inset }
.btn.primary{ --bg:#134b4a } .btn.accent{ --bg:#193f6a } .btn.safe{ --bg:#1b4d2e }
.btn.gold{ --bg:#5a4616 } .btn.violet{ --bg:#3a235a }
.btn:not(.dimmed)::after{
  content:''; position:absolute; inset:-2px; border-radius:14px;
  box-shadow:0 0 0 0 rgba(64,224,208,.65), 0 0 24px 6px color-mix(in oklab,var(--gl),transparent 45%);
  opacity:.9; pointer-events:none; transition:opacity .15s ease
}
.btn.dimmed::after{ opacity:0 }
@keyframes pulse{0%,100%{box-shadow:0 0 0 0 rgba(40,224,192,.45),0 0 18px 6px rgba(40,224,192,.25)}
50%{box-shadow:0 0 0 4px rgba(40,224,192,0),0 0 26px 10px rgba(40,224,192,.35)}}
.btn.primary.ready:not(.dimmed){ animation:pulse 1.6s ease-in-out infinite }

/* ===================== VECTOR CHIPS (CONTROL BAR) ===================== */
#chipsArea .chip-img{
  width: clamp(56px, 7vw, 72px);
  height: clamp(56px, 7vw, 72px);
  border-radius:50%; border:none; background-color:transparent;
  background-repeat:no-repeat; background-position:center; background-size:contain;
  position:relative; cursor:pointer;
}
#chipsArea .chip-img span{ position:absolute; inset:0; color:transparent; font-size:0; line-height:0 }
#chipsArea .chip-img[data-value="5"]   { background-image:url('assets/chip-5.svg') }
#chipsArea .chip-img[data-value="20"]  { background-image:url('assets/chip-20.svg') }
#chipsArea .chip-img[data-value="50"]  { background-image:url('assets/chip-50.svg') }
#chipsArea .chip-img[data-value="100"] { background-image:url('assets/chip-100.svg') }

/* ===================== REALISTIC BET STACKS (INSIDE SEAT) ===================== */
.bet-stack .coin{
  position:absolute; width:44px; height:44px;
  background-repeat:no-repeat; background-position:center; background-size:contain;
  filter: drop-shadow(0 6px 6px rgba(0,0,0,.35));
  transform: translate(0,0) scale(.9);
  transition: transform .25s cubic-bezier(.2,.8,.2,1), opacity .25s;
  will-change: transform; opacity:0;
}
.bet-stack .coin.in{ opacity:1; transform: translate(0,0) scale(1) }
@media (max-width:520px){ .bet-stack .coin{ width:40px; height:40px } }

/* ===================== DESKTOP/TABLET: CHIPS LEFT, BUTTONS RIGHT ===================== */
@media (min-width:900px){
  #seatsArea{ position:relative; padding-bottom:56px; }
  #controlBar{ position:static; display:contents; } /* children position inside seatsArea */

  #chipsArea, #actionButtons{
    position:absolute; top:50%; transform:translateY(-50%);
    display:flex; gap:12px; z-index:30;
  }
  #chipsArea{ left:-96px;  flex-direction:column; }
  #actionButtons{ right:-96px; flex-direction:column; }

  #chipsArea .chip-img{ width:64px; height:64px; }
  #actionButtons .btn{ padding:9px 14px; }
}

/* ===================== MOBILE: SEAT CAROUSEL + STICKY FOOTER ===================== */
@media (max-width:520px){
  #seatsArea{
    display:grid; grid-auto-flow:column; grid-auto-columns:88vw;
    overflow-x:auto; scroll-snap-type:x mandatory; gap:12px;
    padding:16px 6vw 120px;
  }
  #seatsArea::-webkit-scrollbar{ display:none }

  .seat{ scroll-snap-align:center; min-height:62vh; position:relative }
  .bet-box{ top:10px; left:10px; right:10px; bottom:10px }
  .seat .cards{ top:24px; left:24px; right:24px; bottom:68px }
  .seat .bet-stack{ left:14px; transform:none; width:auto; height:auto; bottom:14px }

  .card{ width:clamp(54px,16vw,66px); height:clamp(78px,23vw,96px) }
  .flying-card{ width:clamp(54px,16vw,66px); height:clamp(78px,23vw,96px) }

  #controlBar{
    position:sticky; bottom:0; z-index:1000;
    padding:10px max(8px, env(safe-area-inset-left))
             calc(10px + env(safe-area-inset-bottom))
             max(8px, env(safe-area-inset-right));
    backdrop-filter: blur(8px);
    background: linear-gradient(to top, rgba(8,21,34,.92), rgba(8,21,34,.55));
    display:grid; grid-template-columns:1fr; row-gap:10px;
  }
  #chipsArea{ display:flex; gap:12px; overflow-x:auto; padding:0 4px 2px }
  #chipsArea::-webkit-scrollbar{ display:none }
  #chipsArea .chip-img{ width:56px; height:56px; flex:0 0 auto }

  #actionButtons{ display:grid; grid-template-columns:repeat(3,1fr); gap:8px }
  #actionButtons .btn{ width:100%; padding:11px 0 }

  #seatToggle{ order:-1; justify-content:center; gap:10px }
  #seatToggle button{ padding:8px 12px }
}